<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.0"?>

<!--

-->

<plugin>


       
   
   
     <extension
         point="org.eclipse.ui.commands">
     <category
            id="org.osate.fta.category.commands"
            name="Commands related to FTA">
     </category>

     <command categoryId="org.osate.fta.category.commands"
            id="org.osate.fta.commands.FTA"
            description="View FTA graphically or as minimal cutset table"
            name="View myFTA">
     </command>     

    </extension>
    
    
   	<extension point="org.eclipse.ui.handlers">

        <handler
            class="org.osate.aadl2.errormodel.faulttree.handler.FTAHandler" 
            commandId="org.osate.fta.commands.FTA">
      </handler>
     </extension>  
     
         
    <extension point="org.eclipse.ui.menus">
         <menuContribution locationURI="popup:org.osate.ui.navigator.AadlNavigator?after=additions">
         <menu
               id="org.osate.ui.popupMenu.Analyses"
               label="%popupMenu.analyses.label"
               >
        <menu
               id="org.osate.analysis.architecture.popupMenu.Fault"
               label="%popupMenu.Fault.label"
               >
			<command commandId="org.osate.fta.commands.FTA" 
              icon="icons/fta.png"
				style="push" tooltip="View myFTA">
          <visibleWhen>
            <reference definitionId="org.osate.emfta.compatibleElementSelected">
            </reference>
         </visibleWhen>
			</command>

         </menu>
 
         </menu>

          </menuContribution>
 	</extension>
     
     
     <extension
          point="org.eclipse.core.expressions.definitions">
       <definition id="org.osate.emfta.compatibleElementSelected">
       	<and>
            <reference
                  definitionId="oneElementSelected">
            </reference>
	        <with variable="selection">
	           <iterate ifEmpty="false" operator="and">
	              <or>
	                <adapt type="org.eclipse.core.resources.IFile">
                       <or>
                          <test
                                args="extension"
                                property="org.eclipse.core.resources.extension"
                                value="aaxl2">
                          </test>
                       </or>
	                </adapt>
	              </or>
	           </iterate>
	        </with>
        </and>    
       </definition>
    </extension>
  <extension
       point="org.eclipse.core.expressions.definitions">
    <definition
          id="oneElementSelected">
       <with
             variable="selection">
            <count
                  value="1">
            </count>
             
       </with>
    </definition>
 </extension>
   

</plugin>
